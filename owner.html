<!DOCTYPE html>
<html>
<head>
  <title>Niyalo Owner</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
<body style="font-family:sans-serif;padding:20px;background:#12100e;color:white;">

<div style="max-width:600px;margin:0 auto;background:#fcf7f2;color:black;padding:30px;border-radius:30px;">

  <h1 style="font-size:2rem;">üëë NIYALO OWNER</h1>
  
  <div style="background:#fff1e9;padding:20px;border-radius:20px;margin:20px 0;">
    <div style="display:flex;gap:10px;margin-bottom:15px;">
      <button id="editBtn" style="background:#2d5a4b;color:white;padding:10px 20px;border:none;border-radius:10px;">üîì EDIT ON</button>
      <button id="saveBtn" style="background:#27ae60;color:white;padding:10px 20px;border:none;border-radius:10px;">üíæ SAVE</button>
    </div>
    <div id="status" style="background:#2d5a4b;color:white;padding:10px;border-radius:10px;text-align:center;">READY</div>
  </div>

  <div style="background:white;padding:20px;border-radius:20px;">
    <div style="display:flex;gap:10px;align-items:center;margin-bottom:20px;">
      <span>üè®</span>
      <input type="text" id="hotelName" value="Niyalo Cafe" style="flex:1;padding:10px;border:1px solid #ccc;border-radius:10px;">
    </div>
    
    <div style="display:flex;gap:10px;align-items:center;margin-bottom:20px;">
      <span>üìç</span>
      <input type="text" id="hotelLocation" value="Lakeside, Pokhara" style="flex:1;padding:10px;border:1px solid #ccc;border-radius:10px;">
    </div>
    
    <div style="display:flex;gap:10px;align-items:center;margin-bottom:20px;">
      <span>üìû</span>
      <input type="text" id="phone" value="+977 981-234567" style="flex:1;padding:10px;border:1px solid #ccc;border-radius:10px;">
    </div>
    
    <div style="display:flex;gap:10px;align-items:center;margin-bottom:20px;">
      <span>‚è∞</span>
      <input type="text" id="hours" value="7:00‚Äì22:00 daily" style="flex:1;padding:10px;border:1px solid #ccc;border-radius:10px;">
    </div>
  </div>

</div>

<script>
// ===== YOUR SUPABASE KEYS =====
const SUPABASE_URL = 'https://outxrzhbocvopmvizzf.supabase.co';
const SUPABASE_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im91dHhyemhib2N2b3Btdml6emYiLCJyb2xlIjoiYW5vbiIsImlhdCI6MTczOTU5NzM4NywiZXhwIjoyMDU1MTczMzg3fQ.qLfjrV_XpIs9tRr8CM3c0qOcw23VCl50trbKnS73fYw';

// Initialize Supabase
const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

let isEditMode = true;

// Toggle edit mode
document.getElementById('editBtn').onclick = function() {
  isEditMode = !isEditMode;
  const btn = document.getElementById('editBtn');
  btn.textContent = isEditMode ? 'üîì EDIT ON' : 'üîí EDIT OFF';
  btn.style.background = isEditMode ? '#2d5a4b' : '#7f8c8d';
  
  // Enable/disable inputs
  document.querySelectorAll('input').forEach(input => {
    input.disabled = !isEditMode;
  });
};

// Load data from Supabase
async function loadData() {
  try {
    const { data, error } = await supabase
      .from('menus')
      .select('*')
      .eq('id', 1)
      .single();
    
    if (data && data.data) {
      document.getElementById('hotelName').value = data.data.hotel.name;
      document.getElementById('hotelLocation').value = data.data.hotel.location;
      document.getElementById('phone').value = data.data.hotel.phone;
      document.getElementById('hours').value = data.data.hotel.hours;
      document.getElementById('status').innerHTML = '‚úÖ LOADED FROM CLOUD';
    } else {
      // Save default data first time
      await saveData(false);
    }
  } catch (e) {
    document.getElementById('status').innerHTML = '‚ùå ERROR LOADING';
  }
}

// Save data to Supabase
async function saveData(showAlert = true) {
  const menuData = {
    hotel: {
      name: document.getElementById('hotelName').value,
      location: document.getElementById('hotelLocation').value,
      phone: document.getElementById('phone').value,
      hours: document.getElementById('hours').value
    }
  };
  
  try {
    const { error } = await supabase
      .from('menus')
      .upsert({ id: 1, data: menuData });
    
    if (error) throw error;
    
    document.getElementById('status').innerHTML = '‚úÖ SAVED ' + new Date().toLocaleTimeString();
    if (showAlert) alert('Saved to cloud!');
  } catch (error) {
    alert('Error: ' + error.message);
  }
}

// Save button
document.getElementById('saveBtn').onclick = function() {
  saveData(true);
};

// Load data when page opens
loadData();
</script>

</body>
</html>
