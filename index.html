<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=yes">
  <title>Niyalo Cafe ¬∑ Digital Menu</title>
  <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700;800&family=Playfair+Display:ital,wght@0,400;0,500;0,600;0,700;1,600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    body {
      background: #fcf3ec;
      font-family: 'Plus Jakarta Sans', sans-serif;
      padding: 1.2rem;
      display: flex;
      justify-content: center;
    }
    .container {
      max-width: 1300px;
      width: 100%;
    }
    
    /* ----- MOBILE-FRIENDLY HEADER ----- */
    .header {
      background: #dac1b3;
      background: linear-gradient(145deg, #ddc5b8, #cfb2a2);
      border-radius: 40px 40px 20px 20px;
      padding: 0.8rem 1.2rem;
      margin-bottom: 1.5rem;
      display: flex;
      flex-wrap: wrap;
      align-items: center;
      justify-content: space-between;
      border-bottom: 4px solid #b18067;
    }
    .qr-badge {
      background: #765b4e;
      color: white;
      padding: 0.4rem 1.2rem;
      border-radius: 40px;
      font-weight: 700;
      font-size: 0.85rem;
      display: flex;
      align-items: center;
      gap: 6px;
    }
    .live-badge {
      background: #2d5a4b;
      color: white;
      padding: 0.4rem 1.2rem;
      border-radius: 40px;
      font-size: 0.8rem;
      display: flex;
      align-items: center;
      gap: 6px;
    }
    .pulse {
      width: 8px;
      height: 8px;
      background: #b3f0d0;
      border-radius: 50%;
      animation: pulse 1.5s infinite;
    }
    @keyframes pulse {
      0% { opacity: 0.6; transform: scale(1); }
      100% { opacity: 1; transform: scale(1.2); }
    }
    
    /* ----- MENU CARD (MOBILE OPTIMIZED) ----- */
    .menu-card {
      background: white;
      border-radius: 36px;
      padding: 1.5rem;
      box-shadow: 0 20px 40px -15px rgba(0,0,0,0.15);
    }
    
    /* ----- HOTEL SECTION ----- */
    .hotel-section {
      display: flex;
      flex-wrap: wrap;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1.8rem;
      border-bottom: 2px dashed #dbb9a8;
      padding-bottom: 1.2rem;
    }
    .hotel-name {
      font-family: 'Playfair Display', serif;
      font-size: 2rem;
      font-weight: 700;
      color: #35271f;
      display: flex;
      align-items: center;
      gap: 8px;
      margin-bottom: 0.3rem;
    }
    .hotel-name i {
      color: #b18067;
      font-size: 1.8rem;
    }
    .hotel-tagline {
      display: flex;
      align-items: center;
      gap: 8px;
      color: #6b5548;
      font-size: 0.9rem;
      flex-wrap: wrap;
    }
    .contact-info {
      background: #fff9f2;
      padding: 0.6rem 1.2rem;
      border-radius: 50px;
      display: flex;
      flex-wrap: wrap;
      gap: 1rem;
      font-size: 0.85rem;
      margin-top: 0.5rem;
    }
    
    /* ----- CATEGORIES (MOBILE) ----- */
    .category {
      background: #fffcf7;
      border-radius: 28px;
      padding: 1.2rem;
      margin-bottom: 1.5rem;
      border: 1px solid #f0ddd2;
    }
    .category-title {
      display: flex;
      align-items: center;
      gap: 8px;
      border-bottom: 2px dotted #eacec2;
      padding-bottom: 0.8rem;
      margin-bottom: 0.8rem;
    }
    .category-title i {
      font-size: 1.6rem;
      color: #aa7862;
    }
    .category-title h2 {
      font-family: 'Playfair Display', serif;
      font-size: 1.5rem;
      font-weight: 600;
      color: #3d2c24;
    }
    
    /* ----- MENU ITEMS (MOBILE) ----- */
    .item {
      display: flex;
      justify-content: space-between;
      align-items: baseline;
      padding: 0.6rem 0;
      border-bottom: 1px dashed #efd9cf;
    }
    .item-name {
      font-weight: 700;
      font-size: 1rem;
      display: flex;
      align-items: center;
      gap: 6px;
      flex-wrap: wrap;
    }
    .item-desc {
      font-size: 0.8rem;
      color: #6b5246;
      margin-top: 2px;
    }
    .price {
      font-weight: 800;
      font-size: 1.1rem;
      background: #ffefe7;
      padding: 0.15rem 1rem;
      border-radius: 40px;
      color: #5c3d33;
      white-space: nowrap;
      margin-left: 0.5rem;
    }
    .price:before {
      content: "‡§∞‡•Ç";
      margin-right: 3px;
    }
    .badge {
      background: #e7d2c5;
      border-radius: 40px;
      padding: 0.15rem 0.8rem;
      font-size: 0.6rem;
      font-weight: 700;
      text-transform: uppercase;
    }
    
    /* ----- FOOTER (MOBILE) ----- */
    .footer {
      background: #fdf3ed;
      border-radius: 40px;
      padding: 1.2rem;
      margin-top: 1.5rem;
      text-align: center;
    }
    .footer-badges {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 0.8rem;
      margin-bottom: 0.8rem;
    }
    .footer-badge {
      background: #e7d2c5;
      border-radius: 40px;
      padding: 0.3rem 1rem;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      font-size: 0.8rem;
    }
    
    /* ----- FORCE REFRESH HINT (MOBILE) ----- */
    .refresh-hint {
      display: flex;
      justify-content: center;
      margin-top: 1rem;
      font-size: 0.7rem;
      color: #8b6f63;
    }
    .refresh-hint i {
      margin: 0 4px;
    }
    
    /* ----- OWNER LINK (HIDDEN) ----- */
    .owner-link {
      position: fixed;
      bottom: 10px;
      right: 10px;
      opacity: 0.3;
      font-size: 0.7rem;
    }
    .owner-link a {
      color: #5f4a3d;
      text-decoration: none;
    }
  </style>
</head>
<body>
  <div class="container">
    <!-- HEADER -->
    <div class="header">
      <span class="qr-badge">
        <i class="fas fa-qrcode"></i> NIYALO
      </span>
      <span class="live-badge">
        <span class="pulse"></span> LIVE MENU
      </span>
    </div>
    
    <!-- MENU CONTENT -->
    <div class="menu-card" id="menuContent">
      <div style="text-align:center;padding:2rem;">
        <i class="fas fa-spinner fa-spin" style="font-size:2rem;color:#b18067;"></i>
        <p style="margin-top:1rem;color:#5f4a3d;">Loading menu...</p>
      </div>
    </div>
    
    <!-- FOOTER NOTE -->
    <div class="refresh-hint">
      <i class="fas fa-sync-alt"></i> auto-updates every 2 seconds
    </div>
    
    <!-- OWNER LINK (HIDDEN) -->
    <div class="owner-link">
      <a href="owner.html">‚ö°</a>
    </div>
  </div>

  <script>
    // ===========================================
    // NIYALO ¬∑ MOBILE-OPTIMIZED GUEST MENU
    // FORCES UPDATE EVERY 1 SECOND
    // WORKS ON ALL DEVICES!
    // ===========================================
    
    const DEFAULT_MENU = {
      hotel: {
        name: "Niyalo Cafe",
        location: "Lakeside, Pokhara",
        tagline: "homemade ¬∑ local love",
        hours: "7:00 ‚Äì 22:00 daily",
        phone: "+977 981-234567",
        address: "Lakeside Rd, Pokhara",
        heartNote: "order at counter ¬∑ everything made to share"
      },
      footer: ["house-baked daily", "vegan & gluten-free", "free high-speed wifi"],
      categories: [
        {
          title: "all-day breakfast",
          icon: "sunrise",
          items: [
            { name: "Niyalo Shakshuka", desc: "poached eggs ¬∑ spiced tomato ¬∑ feta", price: "590", badge: null },
            { name: "Cardamom French Toast", desc: "brioche ¬∑ orange ¬∑ maple", price: "520", badge: null },
            { name: "Avocado Garden Toast", desc: "sourdough ¬∑ za'atar ¬∑ radish", price: "580", badge: "vegan" },
            { name: "House Granola Pot", desc: "yoghurt ¬∑ berries ¬∑ honey", price: "420", badge: null }
          ]
        },
        {
          title: "small plates",
          icon: "utensils",
          items: [
            { name: "Burnt Eggplant Dip", desc: "smoked paprika ¬∑ flatbread", price: "450", badge: null },
            { name: "Chili Garlic Prawns", desc: "lemon ¬∑ parsley ¬∑ sourdough", price: "690", badge: null },
            { name: "Wild Mushroom Toast", desc: "thyme ¬∑ truffle oil ¬∑ pecorino", price: "620", badge: "signature" },
            { name: "Harissa Cauliflower", desc: "tahini ¬∑ pomegranate ¬∑ almonds", price: "510", badge: null }
          ]
        },
        {
          title: "bowls & greens",
          icon: "leaf",
          items: [
            { name: "Niyalo Harvest Bowl", desc: "quinoa ¬∑ sweet potato ¬∑ kale ¬∑ miso", price: "650", badge: null },
            { name: "Sesame Salmon", desc: "soba ¬∑ edamame ¬∑ pickled ginger", price: "820", badge: null },
            { name: "Turmeric Coconut Lentils", desc: "brown rice ¬∑ crispy shallots", price: "550", badge: "vegan" }
          ]
        },
        {
          title: "slow sips",
          icon: "mug-saucer",
          items: [
            { name: "House Espresso Blend", desc: "single origin ¬∑ honey process", price: "210", badge: null },
            { name: "Cardamom Rose Latte", desc: "oat milk ¬∑ dried rose petals", price: "290", badge: "best seller" },
            { name: "Iced Turmeric Tonic", desc: "ginger ¬∑ lemon ¬∑ agave", price: "250", badge: null },
            { name: "Salted Honey Affogato", desc: "gelato ¬∑ espresso ¬∑ maldon", price: "360", badge: null }
          ]
        },
        {
          title: "sweet corner",
          icon: "cake",
          items: [
            { name: "Miso Chocolate Chip Cookie", desc: "brown butter ¬∑ sea salt", price: "180", badge: null },
            { name: "Pistachio & Orange Cake", desc: "labneh frosting ¬∑ rose", price: "320", badge: null },
            { name: "Vegan Berry Crumble", desc: "oat topping ¬∑ coconut cream", price: "340", badge: null },
            { name: "Chai-Spiced Bun", desc: "cream cheese drizzle", price: "220", badge: null }
          ]
        },
        {
          title: "cold + curated",
          icon: "wine-bottle",
          items: [
            { name: "Kombucha (rotating)", desc: "ginger ¬∑ lemongrass ¬∑ local", price: "250", badge: null },
            { name: "Orange & Carrot", desc: "cold pressed ¬∑ turmeric", price: "290", badge: null },
            { name: "Michelada", desc: "lime ¬∑ tajin ¬∑ agave", price: "390", badge: null },
            { name: "Hibiscus Spritz", desc: "sparkling ¬∑ mint ¬∑ lime", price: "350", badge: null }
          ]
        }
      ]
    };

    // ---------- RENDER MENU ----------
    function renderMenu(data) {
      let html = `
        <div class="hotel-section">
          <div>
            <div class="hotel-name">
              <i class="fas fa-leaf"></i>
              <span>${data.hotel.name}</span>
              <i class="fas fa-mug-hot"></i>
            </div>
            <div class="hotel-tagline">
              <i class="fas fa-map-pin"></i> ${data.hotel.location}
              <span style="margin:0 4px;">‚Ä¢</span>
              <i class="fas fa-seedling"></i> ${data.hotel.tagline}
            </div>
          </div>
          <div class="contact-info">
            <div><i class="fas fa-clock"></i> ${data.hotel.hours}</div>
            <div><i class="fas fa-phone-alt"></i> ${data.hotel.phone}</div>
          </div>
        </div>
      `;
      
      data.categories.forEach(cat => {
        html += `<div class="category">`;
        html += `<div class="category-title"><i class="fas fa-${cat.icon}"></i><h2>${cat.title}</h2></div>`;
        
        cat.items.forEach(item => {
          html += `<div class="item">`;
          html += `<div style="flex:1">`;
          html += `<div class="item-name">`;
          html += `<span>${item.name}</span>`;
          if (item.badge) {
            html += `<span class="badge">${item.badge}</span>`;
          }
          html += `</div>`;
          html += `<div class="item-desc">${item.desc}</div>`;
          html += `</div>`;
          html += `<span class="price">${item.price}</span>`;
          html += `</div>`;
        });
        html += `</div>`;
      });
      
      html += `<div class="footer">`;
      html += `<div class="footer-badges">`;
      data.footer.forEach(text => {
        html += `<span class="footer-badge"><i class="fas fa-heart"></i> ${text}</span>`;
      });
      html += `</div>`;
      html += `<div style="margin-top:0.5rem; font-size:0.9rem;">`;
      html += `<i class="fas fa-heart" style="color:#c2714b;"></i> ${data.hotel.heartNote} <i class="fas fa-heart" style="color:#c2714b;"></i>`;
      html += `</div>`;
      html += `</div>`;
      
      document.getElementById('menuContent').innerHTML = html;
    }

    // ---------- LOAD FROM LOCALSTORAGE (FORCED EVERY SECOND) ----------
    function loadFromStorage() {
      try {
        const saved = localStorage.getItem('niyalo_live_menu');
        if (saved) {
          const ownerData = JSON.parse(saved);
          const menuData = {
            hotel: ownerData.hotel || DEFAULT_MENU.hotel,
            footer: ownerData.footer ? ownerData.footer.map(f => f.text) : DEFAULT_MENU.footer,
            categories: ownerData.categories || DEFAULT_MENU.categories
          };
          renderMenu(menuData);
          console.log('‚úÖ Menu updated at', new Date().toLocaleTimeString());
        } else {
          // First time - show default
          renderMenu(DEFAULT_MENU);
        }
      } catch(e) {
        console.log('Error loading, using default');
        renderMenu(DEFAULT_MENU);
      }
    }

    // ---------- MOBILE-SPECIFIC FIX: FORCE CHECK EVERY 500ms ----------
    console.log('üöÄ Niyalo Guest Menu - Mobile Optimized');
    
    // Load immediately
    loadFromStorage();
    
    // CRITICAL FOR MOBILE: Check every 500ms (not relying on storage event)
    setInterval(loadFromStorage, 500);
    
    // Also listen for storage events (for desktop)
    window.addEventListener('storage', (e) => {
      if (e.key === 'niyalo_live_menu') {
        console.log('üîÑ Storage event triggered');
        loadFromStorage();
      }
    });
    
    // Force reload when page becomes visible (user switches back to tab)
    document.addEventListener('visibilitychange', () => {
      if (!document.hidden) {
        console.log('üëÅÔ∏è Page visible, reloading menu');
        loadFromStorage();
      }
    });
  </script>
</body>
</html>
